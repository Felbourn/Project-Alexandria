PART
{
	name = His_FASAApollo_SM

	module = Part
	category = Propulsion
	subcategory = 0

	MODEL
	{
		model = FASA/Apollo/ApolloCSM/FASA_Apollo_CSM
		scale = 1.58, 1.58, 1.58
	}
	rescaleFactor = 1
	scale = 1

	node_stack_top = 0.0, 1.58, 0.0,           0.0, 1.0, 0.0,   3
	node_stack_apollo13 = 0, -0.59, 1.08,      0.0, 0.0, 1.0,   1
	node_stack_bottom1 = 1.71, -2.05, -0.20,   0.0, -1.0, 0.0,  1
	node_stack_bottom2 = 0.0, -2.45, 0.0,      0.0, -1.0, 0.0,  3

	attachRules = 1,0,1,1,1

	TechRequired = specializedControl
	entryCost = 11000
	cost = 12000

	title = Apollo Service Module
	manufacturer = Felbourn
	author = Felbourn
	description = Fuel and equipment for the CM (Command Module). 

	mass = 3.287
	CoMOffset = 0.0, 0.6, 0.0

	// 2x tanks @320 pounds oxygen (210 for power, 110 ECLS): 290.3 kg (190.5 power, 99.8 ECLS, 167 L for power)
	// 2x hydrogen tanks @69 lb, carry 28 lb fluid: 62.6 kg with 25.4 kg fluid (358.5 L)
	// 3x battery @1488 Wh and 28 lb: 4464 Wh 38.1 kg
	// 3x fuel cells @250 lb: 340.2 kg
	// 3x inverters at 53 lb: 72.1 kg
	// 15,723 pounds of fuel and 25,140 pounds oxidizer (7131.8 Aerozine50 / 7924.2 L, 11403.3 NTO / 7864.3 L)

	// RCS tanks: 69.1 lb MMH + 137 lb NTO primary, plus 45.2 lb MMH + 89.2 lb NTO backup

	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.2
	angularDrag = 2

	crashTolerance = 12

	maxTemp = 1500

	bulkheadProfiles = size1
	
	MODULE
	{
		name = ModuleAnimateGeneric
		animationName = CSM_Doors
		startEventGUIName = Close
		endEventGUIName = Open
		actionGUIName = Toggle Doors
	}
	MODULE
	{
		name = ModuleCargoBay
		DeployModuleIndex = 0
		closedPosition = 1
		lookupRadius = 1.8		
		nodeOuterForeID = top
		nodeOuterAftID = bottom2
	}

	MODULE
	{
	    name = FlagDecal
	    textureQuadName = Flag
	}

	MODULE
	{
		name = ModuleFuelTanks
		volume = 16547.86
		type = ServiceModule
		basemass = -1
		TANK
		{
			name = ElectricCharge
			amount = 4800
			maxAmount = 4800
		}
		TANK
		{
			name = Aerozine50
			amount = 7945.9 // SPS			
			maxAmount = 7945.9
		}
		TANK
		{
			name = NTO
			amount = 7885.3
			maxAmount = 7885.3
		}
		TANK
		{
			name = Hydrogen (Fuel Cell)
			amount = 372.62
			maxAmount = 372.62
		}
		TANK
		{
			name = Oxygen (Fuel Cell)
			amount = 183.64
			maxAmount = 183.64
		}
		TANK
		{
			name = MMH (RCS)
			amount = 58.8
			maxAmount = 58.8
		}
		TANK
		{
			name = NTO (RCS)
			amount = 70.8
			maxAmount = 70.8
		}
		TANK
		{
			name = Water
			amount = 1
			maxAmount = 26
		}
	}	

	MODULE
	{
		name = TweakScale
		type = free
	}

	MODULE
	{
		name = ModuleSeeThroughObject
		transformName = CSM_Hatch
	}
	
    MODULE
    {
        name = ReflectiveShaderModule
        CubeMapSize = 8
        FarClipPlane = 500000000
		NearClipPlane = 2
        OneFacePerFrame = true
        ShaderName = Reflective/Bumped Specular
		realTimeReflection = False
        ParallaxHeight = 0.01
        ReflectionStrength = 0.12
        MeshesToChange = CSM,CSM_Hatch
        Shininess = 1.0
		updateRate = 118
        SpecColorR = 0.8
        SpecColorG = 0.8
        SpecColorB = 0.8
        SpecColorA = 0.8
		rimFalloff = 5.0
		rimColor = 0.642, 0.6445, 0.6414, 1.0
		ReflectionColor = 0.6442, 0.6445, 0.64, 1.0
    }

	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = Fuel Cell 1
		StartActionName = Start Fuel Cell 1
		StopActionName = Stop Fuel Cell 1
		AutoShutdown = true

		INPUT_RESOURCE
		{
			ResourceName = Hydrogen (Fuel Cell)
			Ratio = 0.000303983
			FlowMode = STAGE_PRIORITY_FLOW
		}
		INPUT_RESOURCE
		{
			ResourceName = Oxygen (Fuel Cell)
			Ratio = 0.00014981
			FlowMode = STAGE_PRIORITY_FLOW
		}
		OUTPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 0.638888889 // max 2300 watts
			DumpExcess = false
		}
		OUTPUT_RESOURCE
		{
			ResourceName = Water
			Ratio = 0.000192471
			DumpExcess = false
			FlowMode = STAGE_PRIORITY_FLOW
		}
	}

	MODULE
	{
		name = ModuleCommand
		minimumCrew = 1
		RESOURCE
		{
			name = ElectricCharge
			rate = 0.188
		}
	}
}

@PART[His_FASAApollo_SM]
{
	+MODULE[ModuleResourceConverter]
	{
		@ConverterName = Fuel Cell 2
		@StartActionName = Start Fuel Cell 2
		@StopActionName = Stop Fuel Cell 2
	}
	+MODULE[ModuleResourceConverter]
	{
		@ConverterName = Fuel Cell 3
		@StartActionName = Start Fuel Cell 3
		@StopActionName = Stop Fuel Cell 3
	}
}